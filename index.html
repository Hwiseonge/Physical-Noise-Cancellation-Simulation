<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê³ ì£¼íŒŒ vs ì €ì£¼íŒŒ ANC í•œê³„ ì‹œë®¬ë ˆì´ì…˜</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6fa;
      text-align: center;
    }
    canvas {
      background: white;
      border: 1px solid #ccc;
      margin-top: 10px;
    }
    .controls {
      margin: 15px;
    }
    label {
      display: inline-block;
      width: 160px;
    }
    button {
      margin: 5px;
      padding: 6px 12px;
    }
  </style>
</head>
<body>

<h2>ê³ ì£¼íŒŒÂ·ì €ì£¼íŒŒì—ì„œ ANC ì„±ëŠ¥ ë¹„êµ ì‹œë®¬ë ˆì´ì…˜</h2>
<p>
  ğŸ”´ ì™¸ë¶€ ì†ŒìŒ | ğŸ”µ ì´ì–´í° | âš« í•©ì„± | ğŸŸ¢ í‰í˜• ìœ„ì¹˜
</p>

<div class="controls">
  <div>
    <button onclick="setLowFreq()">ì €ì£¼íŒŒ ì†ŒìŒ</button>
    <button onclick="setHighFreq()">ê³ ì£¼íŒŒ ì†ŒìŒ</button>
  </div>
  <div>
    <label>ì™¸ë¶€ ì†ŒìŒ íŒŒì¥</label>
    <input type="range" min="40" max="200" value="120" id="wavelength">
  </div>
</div>

<canvas id="canvas" width="900" height="360"></canvas>

<script>
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");

  const wavelengthSlider = document.getElementById("wavelength");

  const centerY = 180;
  let t = 0;

  let noiseLambda = 120;        // ì™¸ë¶€ ì†ŒìŒ íŒŒì¥
  let earLambda = 120;          // ì´ì–´í° íŒŒì¥ (ì§€ì—° ë°˜ì˜)
  const followSpeed = 0.02;     // 1ì´ˆ ì •ë„ ê±¸ë ¤ ë”°ë¼ê°€ê²Œ ì¡°ì ˆ

  function setLowFreq() {
    noiseLambda = 150;
    wavelengthSlider.value = 150;
  }

  function setHighFreq() {
    noiseLambda = 60;
    wavelengthSlider.value = 60;
  }

  function drawCenterLine() {
    ctx.beginPath();
    ctx.setLineDash([8, 6]);
    ctx.moveTo(0, centerY);
    ctx.lineTo(canvas.width, centerY);
    ctx.strokeStyle = "green";
    ctx.lineWidth = 1.5;
    ctx.stroke();
    ctx.setLineDash([]);
  }

  function drawWave(color, lambda, phaseShift) {
    ctx.beginPath();
    for (let x = 0; x < canvas.width; x++) {
      const y = 40 * Math.sin((2 * Math.PI / lambda) * x - t + phaseShift);
      ctx.lineTo(x, centerY - y);
    }
    ctx.strokeStyle = color;
    ctx.lineWidth = 2;
    ctx.stroke();
  }

  function drawObjects() {
    ctx.fillStyle = "#555";
    ctx.fillRect(40, centerY - 20, 90, 40);
    ctx.fillText("ì™¸ë¶€ ì†ŒìŒì›", 40, centerY - 30);

    ctx.fillStyle = "#222";
    ctx.beginPath();
    ctx.arc(830, centerY, 30, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillText("ì´ì–´í°", 810, centerY + 45);
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // ì™¸ë¶€ ì†ŒìŒ íŒŒì¥ ì¦‰ì‹œ ë°˜ì˜
    noiseLambda = Number(wavelengthSlider.value);

    // ì´ì–´í° íŒŒì¥ì´ 1ì´ˆì— ê±¸ì³ ì²œì²œíˆ ë”°ë¼ê° (ì§€ì—°)
    earLambda += (noiseLambda - earLambda) * followSpeed;

    drawCenterLine();
    drawObjects();

    // ğŸ”´ ì™¸ë¶€ ì†ŒìŒ
    drawWave("red", noiseLambda, 0);

    // ğŸ”µ ì´ì–´í° (í•­ìƒ ë°˜ëŒ€ ìœ„ìƒ)
    drawWave("blue", earLambda, Math.PI);

    // âš« í•©ì„± íŒŒë™
    ctx.beginPath();
    for (let x = 0; x < canvas.width; x++) {
      const noise = 40 * Math.sin((2 * Math.PI / noiseLambda) * x - t);
      const cancel = 40 * Math.sin((2 * Math.PI / earLambda) * x - t + Math.PI);
      ctx.lineTo(x, centerY - (noise + cancel));
    }
    ctx.strokeStyle = "black";
    ctx.lineWidth = 2;
    ctx.stroke();

    t += 0.12;
    requestAnimationFrame(draw);
  }

  draw();
</script>

</body>
</html>
